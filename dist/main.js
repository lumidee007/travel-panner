var Client;(()=>{"use strict";var e={d:(t,a)=>{for(var n in a)e.o(a,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:a[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};async function a(e){e.preventDefault();let t=document.querySelector(".travel-date").value,a=document.querySelector(".travel-input").value;Client.clearText();let n=new Date(t).getTime(),i=(new Date).getTime();if(""!==t&&""!==a&&n>i){let e=Math.ceil((new Date(t)-new Date)/864e5);try{let n="18393364-b93a8cbe009d33fa4364578e1",i=await fetch(`https://pixabay.com/api/?key=${n}&q=${a}&image_type=photo`),o=await i.json(),s=o.hits.length>0?o.hits[0].webformatURL:"https://images.unsplash.com/photo-1495954484750-af469f2f9be5?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=MnwxNDI0NzB8MHwxfHJhbmRvbXx8fHx8fHx8fDE2MzI1NTQ0MjY&ixlib=rb-1.2.1&q=80&w=1080";const r=await fetch(`http://api.geonames.org/searchJSON?q=${a}&username=famoochi`),c=await r.json(),l=c.geonames[0].lat,d=c.geonames[0].lng,p=c.geonames[0].countryName?c.geonames[0].countryName:"---",m=c.geonames[0].name;let u="80da14218e3c4dd798f7f1cf19ec2ee8",y=e>7?await fetch(`https://api.weatherbit.io/v2.0/forecast/daily?city=${a}&key=${u}`):await fetch(`https://api.weatherbit.io/v2.0/current?lat=${l}&lon=${d}&key=${u}&include=minutely`);const h=await y.json();let v=void 0!==h.data[0].max_temp?h.data[0].max_temp:"---",f=void 0!==h.data[0].min_temp?h.data[0].min_temp:"---",w=h.data[0].temp,g=h.data[0].weather.description,b=h.data[0].weather.icon,T=e>1?"days away":1==e?"day away":"your trip is today.",x={name:m,countryName:p,date:t,daysDiff:e,lat:l,long:d,maxTemp:v,minTemp:f,weatherInfo:g,icon:b,destinationImg:s,temp:w,dayText:T};const M=e=>document.querySelector(e);let $=M(".destinationName"),S=M("#destName"),I=M("#destCountry"),H=M(".remainingDays"),L=M(".high"),D=M(".low"),q=M(".date"),N=M(".weatherInfo"),j=M(".travelImage"),C=M("#travel-section"),O=M(".temp"),k=M(".icon"),_=M("#text");$.innerHTML=m,S.innerHTML=m,I.innerHTML=p,H.innerHTML=e,L.innerHTML=v,D.innerHTML=f,q.innerHTML=t,N.innerHTML=g,j.src=s,C.style.display="block",k.setAttribute("src",`https://www.weatherbit.io/static/img/icons/${b}.png`),O.innerHTML=w,_.innerHTML=T;const E={method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify(x)},P=await fetch("http://localhost:1922/weather",E);await P.json()}catch(e){console.log(e)}}else alert("Please ensure the destination and travel date are correct")}function n(e){e.preventDefault(),document.querySelectorAll(".target").forEach((e=>{e.addEventListener("click",(()=>{e.remove()}))}))}function i(){document.getElementById("travel-section").style.display="none"}async function o(){try{const e=await fetch("http://localhost:1922/weather"),t=await e.json();document.querySelector("#travel-section").style.display="none",document.querySelector(".output").style.display="flex";let a=document.createElement("div");a.setAttribute("class","travelDetails"),a.classList.add("target"),a.innerHTML=`\n        <div class="imgContainer">\n            <img class="travelImage" src="${t.destinationImg}" alt="destination picture" >\n        </div>\n        <div class="travel-info"> \n            <h3>My trip to: <span id="destName">${t.name}</span> , <span id="destCountry">${t.countryName}</span>; \n            <br>Departing: <span id="datenow"> ${t.date}  </span> \n            </h3>\n            <div class="SaveRemove">\n                <button id="remove" onclick="Client.removeUI(event)">Remove Trip</button>\n            </div>\n\n\n            <div id="icon">\n                    <div class="iconTemp">\n                        <div><img class="icon" src="https://www.weatherbit.io/static/img/icons/${t.icon}.png"></div>\n                        <p> <span class="temp">${t.temp}</span>Âºc</p>\n                    </div>\n                    <p><span class="destinationName">${t.name}</span>, is <span class="remainingDays">${t.daysDiff}</span> <span id="text">${t.dayText}</span></p>\n            </div>\n            \n            <p id='weather-p'>Typical weather for then is;</p>\n            <p id="weatherInfo"> <span class="weatherInfo">${t.weatherInfo}</span>.</p>\n            <div class="travel-temp-info">\n                    <p>Max temp: <span class="high">${t.maxTemp}</span></p>\n                    <p>Min temp: <span class="low">${t.minTemp}</span></p>\n            </div>\n            \n        </div>  \n       `,document.querySelector(".output").prepend(a)}catch(e){console.log(e)}}e.r(t),e.d(t,{clearText:()=>s,handleSubmit:()=>a,removeInfo:()=>i,removeUI:()=>n,updateUI:()=>o}),document.querySelector(".save").addEventListener("click",o);const s=()=>{document.querySelector(".travel-date").value="",document.querySelector(".travel-input").value=""};Client=t})();